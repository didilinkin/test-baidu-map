function ulListControl(){this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new BMap.Size(10,10)}function remove_overlay(){map.clearOverlays()}function hideOver(){circle.hide()}function searchFunction(t){remove_overlay(),map.addOverlay(circle),local.searchNearby(t,mPoint,900)}function oneAddOverlay(t,e){var n=new BMap.Marker(new BMap.Point(t,e));map.addOverlay(n)}function OutputList(t,e){var n={onSearchComplete:function(t){if(i.getStatus()==BMAP_STATUS_SUCCESS)for(var n=[],a=0;a<5;a++){var n=new Object;n.title=t.getPoi(a).title,n.pointLng=t.getPoi(a).point.lng,n.pointLat=t.getPoi(a).point.lat;var o=document.getElementById(e),r=document.createElement("li"),l=n.title,c=document.createTextNode(l);r.appendChild(c),o.appendChild(r)}}},i=new BMap.LocalSearch(map,n);i.searchNearby(t,mPoint,900),searchFunction(t)}function aOutputList(t,e,n){var i={onSearchComplete:function(t){if(a.getStatus()==BMAP_STATUS_SUCCESS){for(var i=[],o=0;o<5;o++){var i=new Object;i.title=t.getPoi(o).title,i.pointLng=t.getPoi(o).point.lng,i.pointLat=t.getPoi(o).point.lat,i.num=t.getCurrentNumPois(o);var r=document.getElementById(n),l=document.getElementById(e),c=document.createElement("li"),s=i.title,u=i.num,d=document.createTextNode(s),p=document.createTextNode(u);c.appendChild(d),l.appendChild(c)}console.log(i.num),r.appendChild(p)}}},a=new BMap.LocalSearch(map,i);a.searchNearby(t,mPoint,900)}function reloadList(){for(var t=[{title:"公交站",ulId:"List-traffic",pId:"Num-traffic"},{title:"快餐",ulId:"List-snack",pId:"Num-snack"},{title:"餐厅",ulId:"List-restaurant",pId:"Num-restaurant"},{title:"银行",ulId:"List-bank",pId:"Num-bank"},{title:"酒店",ulId:"List-hotel",pId:"Num-hotel"}],e=0;e<t.length;e++)aOutputList(t[e].title,t[e].ulId,t[e].pId);remove_overlay(),oneAddOverlay(120.3845,36.071702)}function ComplexCustomOverlay(t,e,n,i,a,o,r,l,c,s){this._point=t,this._text=e,this._overText=n,this.code=i,this.name=a,this.longitude=o,this.latitude=r,this.resourceAmount=l,this.priceBeginning=c,this.beginUnit=s}function addBuilding(t){for(var e=0;e<t.length;e++){var n=new Object;n=t[e];var i="￥"+n.priceBeginning+n.beginUnit+"起",a=n.name+" "+n.resourceAmount+"套",o=new ComplexCustomOverlay(new BMap.Point(n.longitude,n.latitude),i,a);map.addOverlay(o)}}var map=new BMap.Map("allmap"),mPoint=new BMap.Point(120.3845,36.071702);map.addControl(new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_RIGHT,type:BMAP_NAVIGATION_CONTROL_SMALL})),map.enableScrollWheelZoom(),map.centerAndZoom(mPoint,15);var circle=new BMap.Circle(mPoint,1e3,{fillColor:"#FF2725",strokeWeight:2,strokeColor:"#FF2725",fillOpacity:.07,strokeOpacity:1});ulListControl.prototype=new BMap.Control,ulListControl.prototype.initialize=function(t){var e=document.createElement("ul");e.id="ulList";for(var n=null,i=["周边房源","交通","快餐","餐厅","银行","酒店"],o=["housing","traffic","snack","restaurant","bank","hotel"],r=0;r<6;r++)n=document.createElement("li"),a=document.createElement("a"),a.setAttribute("herf","#"),a.appendChild(document.createTextNode(i[r])),a.id="search-"+o[r],e.appendChild(n),n.appendChild(a);return t.getContainer().appendChild(e),e};var myUlListControl=new ulListControl;map.addControl(myUlListControl),searchHousing=document.getElementById("search-housing"),searchTraffic=document.getElementById("search-traffic"),searchSnack=document.getElementById("search-snack"),searchRestaurant=document.getElementById("search-restaurant"),searchBank=document.getElementById("search-bank"),searchHotel=document.getElementById("search-hotel"),map.addOverlay(circle);var local=new BMap.LocalSearch(map,{renderOptions:{map:map,autoViewport:!1}});searchHousing.onclick=function(){remove_overlay(),map.addOverlay(circle),addBuilding(buildingMarker)},searchTraffic.onclick=function(){OutputList("公交站","List-traffic")},searchSnack.onclick=function(){OutputList("快餐","List-snack")},searchRestaurant.onclick=function(){OutputList("餐厅","List-restaurant")},searchBank.onclick=function(){OutputList("银行","List-bank")},searchHotel.onclick=function(){OutputList("酒店","List-hotel")},reloadList();var Btntraffic=document.getElementById("OutputList-traffic"),Btnsnack=document.getElementById("OutputList-snack"),Btnrestaurant=document.getElementById("OutputList-restaurant"),Btnbank=document.getElementById("OutputList-bank"),Btnhotel=document.getElementById("OutputList-hotel");Btntraffic.onclick=function(){OutputList("公交站","List-traffic")},Btnsnack.onclick=function(){OutputList("快餐","List-snack")},Btnrestaurant.onclick=function(){OutputList("餐厅","List-restaurant")},Btnbank.onclick=function(){OutputList("银行","List-bank")},Btnhotel.onclick=function(){OutputList("酒店","List-hotel")};var buildingMarker=[{code:"A001",name:"市政府",longitude:"120.389014",latitude:"36.073178",resourceAmount:10,priceBeginning:11,beginUnit:""},{code:"A002",name:"世贸中心",longitude:"120.383566",latitude:"36.06843",resourceAmount:20,priceBeginning:21,beginUnit:""},{code:"A003",name:"亚麦国际中心",longitude:"120.383602",latitude:"36.070447",resourceAmount:30,priceBeginning:31,beginUnit:""}];ComplexCustomOverlay.prototype=new BMap.Overlay,ComplexCustomOverlay.prototype.initialize=function(t){this._map=t;var e=this._div=document.createElement("div");e.style.position="absolute",e.style.zIndex=BMap.Overlay.getZIndex(this._point.lat),e.style.backgroundColor="#EE5D5B",e.style.border="1px solid #BC3B3A",e.style.color="white",e.style.height="18px",e.style.padding="2px",e.style.lineHeight="18px",e.style.whiteSpace="nowrap",e.style.MozUserSelect="none",e.style.fontSize="12px";var n=this._span=document.createElement("span");e.appendChild(n),n.appendChild(document.createTextNode(this._text));var i=this,a=this._arrow=document.createElement("div");return a.style.background="url(http://map.baidu.com/fwmap/upload/r/map/fwmap/static/house/images/label.png) no-repeat",a.style.position="absolute",a.style.width="11px",a.style.height="10px",a.style.top="22px",a.style.left="10px",a.style.overflow="hidden",e.appendChild(a),e.onmouseover=function(){this.style.backgroundColor="#6BADCA",this.style.borderColor="#0000ff",this.getElementsByTagName("span")[0].innerHTML=i._overText,a.style.backgroundPosition="0px -20px"},e.onmouseout=function(){this.style.backgroundColor="#EE5D5B",this.style.borderColor="#BC3B3A",this.getElementsByTagName("span")[0].innerHTML=i._text,a.style.backgroundPosition="0px 0px"},t.getPanes().labelPane.appendChild(e),e},ComplexCustomOverlay.prototype.draw=function(){var t=this._map,e=t.pointToOverlayPixel(this._point);this._div.style.left=e.x-parseInt(this._arrow.style.left)+"px",this._div.style.top=e.y-30+"px"};