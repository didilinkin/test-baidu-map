function ulListControl(){this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new BMap.Size(10,10)}function remove_overlay(){map.clearOverlays()}function searchFunction(e){remove_overlay(),map.addOverlay(circle),local.searchNearby(e,mPoint,900)}function OutputList(e,t){var n={onSearchComplete:function(e){if(o.getStatus()==BMAP_STATUS_SUCCESS)for(var n=[],a=0;a<5;a++){var n=new Object;n.title=e.getPoi(a).title,n.pointLng=e.getPoi(a).point.lng,n.pointLat=e.getPoi(a).point.lat;var i=document.getElementById(t),r=document.createElement("li"),l=n.title,s=document.createTextNode(l);r.appendChild(s),i.appendChild(r),console.log(n)}}},o=new BMap.LocalSearch(map,n);o.searchNearby(e,mPoint,900),searchFunction(e)}function ComplexCustomOverlay(e,t,n,o,a,i,r,l,s,c){this._point=e,this._text=t,this._overText=n,this.code=o,this.name=a,this.longitude=i,this.latitude=r,this.resourceAmount=l,this.priceBeginning=s,this.beginUnit=c}function addBuilding(e){for(var t=0;t<e.length;t++){var n=new Object;n=e[t];var o="￥"+n.priceBeginning+n.beginUnit+"起",a=n.name+" "+n.resourceAmount+"套",i=new ComplexCustomOverlay(new BMap.Point(n.longitude,n.latitude),o,a);map.addOverlay(i)}}var map=new BMap.Map("allmap"),mPoint=new BMap.Point(120.3845,36.071702);map.addControl(new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_RIGHT,type:BMAP_NAVIGATION_CONTROL_SMALL})),map.enableScrollWheelZoom(),map.centerAndZoom(mPoint,15);var circle=new BMap.Circle(mPoint,1e3,{fillColor:"#FF2725",strokeWeight:2,strokeColor:"#FF2725",fillOpacity:.07,strokeOpacity:1});ulListControl.prototype=new BMap.Control,ulListControl.prototype.initialize=function(e){var t=document.createElement("ul");t.id="ulList";for(var n=null,o=["周边房源","交通","快餐","餐厅","银行","酒店"],i=["housing","traffic","snack","restaurant","bank","hotel"],r=0;r<6;r++)n=document.createElement("li"),a=document.createElement("a"),a.setAttribute("herf","#"),a.appendChild(document.createTextNode(o[r])),a.id="search-"+i[r],t.appendChild(n),n.appendChild(a);return e.getContainer().appendChild(t),t};var myUlListControl=new ulListControl;map.addControl(myUlListControl),searchHousing=document.getElementById("search-housing"),searchTraffic=document.getElementById("search-traffic"),searchSnack=document.getElementById("search-snack"),searchRestaurant=document.getElementById("search-restaurant"),searchBank=document.getElementById("search-bank"),searchHotel=document.getElementById("search-hotel"),map.addOverlay(circle);var local=new BMap.LocalSearch(map,{renderOptions:{map:map,autoViewport:!1}});searchHousing.onclick=function(){remove_overlay(),map.addOverlay(circle),addBuilding(buildingMarker)},searchTraffic.onclick=function(){OutputList("公交站","List-traffic")},searchSnack.onclick=function(){OutputList("快餐","List-snack")},searchRestaurant.onclick=function(){OutputList("餐厅","List-restaurant")},searchBank.onclick=function(){OutputList("银行","List-bank")},searchHotel.onclick=function(){OutputList("酒店","List-hotel")};var buildingMarker=[{code:"A001",name:"市政府",longitude:"120.389014",latitude:"36.073178",resourceAmount:10,priceBeginning:11,beginUnit:""},{code:"A002",name:"世贸中心",longitude:"120.383566",latitude:"36.06843",resourceAmount:20,priceBeginning:21,beginUnit:""},{code:"A003",name:"亚麦国际中心",longitude:"120.383602",latitude:"36.070447",resourceAmount:30,priceBeginning:31,beginUnit:""}];ComplexCustomOverlay.prototype=new BMap.Overlay,ComplexCustomOverlay.prototype.initialize=function(e){this._map=e;var t=this._div=document.createElement("div");t.style.position="absolute",t.style.zIndex=BMap.Overlay.getZIndex(this._point.lat),t.style.backgroundColor="#EE5D5B",t.style.border="1px solid #BC3B3A",t.style.color="white",t.style.height="18px",t.style.padding="2px",t.style.lineHeight="18px",t.style.whiteSpace="nowrap",t.style.MozUserSelect="none",t.style.fontSize="12px";var n=this._span=document.createElement("span");t.appendChild(n),n.appendChild(document.createTextNode(this._text));var o=this,a=this._arrow=document.createElement("div");return a.style.background="url(http://map.baidu.com/fwmap/upload/r/map/fwmap/static/house/images/label.png) no-repeat",a.style.position="absolute",a.style.width="11px",a.style.height="10px",a.style.top="22px",a.style.left="10px",a.style.overflow="hidden",t.appendChild(a),t.onmouseover=function(){this.style.backgroundColor="#6BADCA",this.style.borderColor="#0000ff",this.getElementsByTagName("span")[0].innerHTML=o._overText,a.style.backgroundPosition="0px -20px"},t.onmouseout=function(){this.style.backgroundColor="#EE5D5B",this.style.borderColor="#BC3B3A",this.getElementsByTagName("span")[0].innerHTML=o._text,a.style.backgroundPosition="0px 0px"},e.getPanes().labelPane.appendChild(t),t},ComplexCustomOverlay.prototype.draw=function(){var e=this._map,t=e.pointToOverlayPixel(this._point);this._div.style.left=t.x-parseInt(this._arrow.style.left)+"px",this._div.style.top=t.y-30+"px"};